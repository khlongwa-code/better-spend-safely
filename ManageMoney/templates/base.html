<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banking App</title>
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>
<body>

    <!-- Navbar -->
    <nav>
        <div class="navbar">
            <!-- Logo Section -->
            <div class="logo">
                <img src="{% static 'images/logo.png' %}" alt="UniSave Logo" class="logo-icon">
                <a href="#">UniSave</a>
            </div>

            <!-- Navigation Links -->
            <ul class="nav-links">
                <li><a href="#">Home</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Accounts</a></li>
                <li><a href="#">Distributions</a></li>
                <li><a href="#">Help</a></li>
            </ul>

            <!-- Notification Icon Section -->
            <div class="notifications">
                <img src="{% static 'images/notification.png' %}" alt="Notifications" class="notification-icon">
                <span class="notification-count">0</span>
            </div>
        </div>
    </nav>

    <div class="big-text">
        <!-- The text will be modified by the JavaScript based on user status -->
        <a href="#" id="welcomeText">
            {% if registered_user %}
                Welcome, {{ registered_user }} ! <!-- This will be replaced by JS if needed -->
            {% else %}
                Create an account to continue
            {% endif %}
        </a>
    </div>
    
    <!-- Dashboard with icons -->
    <div class="dashboard">
        <div class="icon-block">
            <img src="{% static 'images/income.png' %}" alt="Income Icon">
            <h2>Income</h2>
        </div>
        <div class="icon-block">
            <img src="{% static 'images/transaction.png' %}" alt="Transactions Icon">
            <h2>Transactions</h2>
        </div>
        <div class="icon-block">
            <img src="{% static 'images/budget.png' %}" alt="Budget Icon">
            <h2>Budget</h2>
        </div>
        <div class="icon-block">
            <img src="{% static 'images/savings.png' %}" alt="Savings Icon">
            <h2>Savings</h2>
        </div>
        <div class="icon-block">
            <img src="{% static 'images/expenses.png' %}" alt="Expenses Icon">
            <h2>Expenses</h2>
        </div>
        <div class="icon-block">
            <img src="{% static 'images/simulator.png' %}" alt="Simulator Icon">
            <h2>Simulator</h2>
        </div>
    </div>

    <div class="login-button">
        {% if show_signup_button %}
            <button onclick="toggleSignUpForm()" id="signupBtn">Sign Up</button>
        {% endif %}
        {% if show_login_button %}
            <button onclick="toggleLoginForm()" id="loginBtn">Sign In</button>
        {% endif %}
        {% if show_signout_button %}
            <button id="logoutBtn">Sign Out</button>
        {% endif %}
    </div>
    
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="form-container">
                <h2>Login</h2>
                <form method="POST" action="{% url 'login' %}">
                    {% csrf_token %}
                    <label for="username">Username</label>
                    {{ login_form.username }}

                    <label for="password">Password</label>
                    {{ login_form.password }}

                    <button type="submit">Submit</button>
                </form>
            </div>
        </div>

    </div>

    <div id="signupModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="form-container">
                <h2>SignUp</h2>
                <form method="POST" action="{% url 'signup' %}">
                    {% csrf_token %}
                    <label for="firstname">First name:</label>
                    {{ signup_form.first_name }}

                    <label for="lastname">Last name:</label>
                    {{ signup_form.last_name }}

                    <label for="email">Email:</label>
                    {{ signup_form.email }}

                    <label for="username">Username:</label>
                    {{ signup_form.username }}

                    <label for="password">Password</label>
                    {{ signup_form.password1 }}

                    <label for="password">Confirm Password:</label>
                    {{ signup_form.password2 }}

                    <button type="submit">Submit</button>
                </form>
            </div>
        </div>

    </div>

    <footer>
        <p>&copy; 2024 My Banking App</p>
    </footer>

    <script>
        var modal = document.getElementById("loginModal");
        var loginBtn = document.getElementById("loginBtn");
        var closeBtn = document.getElementsByClassName("close")[0];

        loginBtn.onclick = function() {
            modal.style.display = "block";
        }

        closeBtn.onclick = function() {
            modal.style.display = "none";
        }

        

        var signupModal = document.getElementById("signupModal");
        var signupBtn = document.getElementById("signupBtn");
        var closeSignupBtn = document.getElementsByClassName("close")[1];

        signupBtn.onclick = function() {
            signupModal.style.display = "block";
        }

        closeSignupBtn.onclick = function() {
            signupModal.style.display = "none";
        }

        function toggleSignUpForm() {
            var signupModal = document.getElementById("signupModal");
            signupModal.style.display = signupModal.style.display === "block" ? "none" : "block";
        }

        window.onclick = function(event) {
            if (event.target == modal || event.target == signupModal) {
                modal.style.display = "none";
                signupModal.style.display = "none";
            }
        }

        

        window.onload = function() {
            const registeredUser = "{{ registered_user }}"; // Ensure this is None or an empty string if no user is logged in
            const bigTextElement = document.querySelector('.big-text a');
            const loginBtn = document.getElementById('loginBtn');
            const signupBtn = document.getElementById('signupBtn');

            // Trim the registeredUser variable to avoid "Welcome back, None" when it should show "Create an account"
            if (registeredUser && registeredUser.trim() !== '') {
                bigTextElement.textContent = `Welcome back, ${registeredUser}`;
                loginBtn.textContent = 'Login';
                loginBtn.style.display = 'block'; 
                signupBtn.style.display = 'none'; // Hide the signup button
            } else {
                bigTextElement.textContent = 'Create an account to continue';
                signupBtn.style.display = 'block'; // Show the signup button
            }
        }


    </script>
</body>
</html>
